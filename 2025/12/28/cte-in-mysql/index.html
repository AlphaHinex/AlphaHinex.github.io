
<!DOCTYPE html>
<html lang="zh-CN" class="loading">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>【转】解析 MySQL CTE：WITH 与 WITH RECURSIVE - Alpha Hinex&#39;s Blog</title>
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="google" content="notranslate" />
    <meta name="keywords" content="Java, JavaScript, Spring, Html5, NoSQL, Docker, DevOps,CTE, Common Table Expressions, WITH, WITH RECURSIVE, MySQL, SQL"> 
    <meta name="description" content="
原文地址：https://wyiyi.github.io/amber/2025/12/20/CTE/

在开发过程中，发现在 MYSQL 的 Mapper 文件中会用到 WITH 关键字，有一些疑,"> 
    <meta name="author" content="Alpha Hinex"> 

    <meta name="msvalidate.01" content="D769824B4D44C14A4C777A6EC4E898FC"> 
    <meta name="baidu-site-verification" content="TimiEK4Y9V"> 
    <meta name="google-site-verification" content="B-WME81HWSnMIkZZxcxv7bVI6yjbpAFKvifi2X-EkzQ"> 

    <link rel="alternative" href="atom.xml" title="Alpha Hinex&#39;s Blog" type="application/atom+xml"> 
    <link rel="icon" href="/img/favicon.png"> 
    <link href="https://fonts.loli.net/css?family=Roboto+Mono|Rubik&display=swap" rel="stylesheet">
    
<link rel="stylesheet" href="//at.alicdn.com/t/font_1429596_nzgqgvnmkjb.css">

    
<link rel="stylesheet" href="//mirrors.sustech.edu.cn/cdnjs/ajax/libs/animate.css/3.7.2/animate.min.css">

    
<link rel="stylesheet" href="/css/share.min.css">

    
<link rel="stylesheet" href="//mirrors.sustech.edu.cn/cdnjs/ajax/libs/codemirror/5.48.4/codemirror.min.css">

    
<link rel="stylesheet" href="//mirrors.sustech.edu.cn/cdnjs/ajax/libs/codemirror/5.48.4/theme/dracula.css">

    
<link rel="stylesheet" href="/css/obsidian.css">

    
<link rel="stylesheet" href="/css/ball-atom.min.css">

<meta name="generator" content="Hexo 4.2.1"></head>


<body class="loading">
    <div class="loader">
        <div class="la-ball-atom la-2x">
            <div></div>
            <div></div>
            <div></div>
            <div></div>
        </div>
    </div>
    <span id="config-title" style="display:none">Alpha Hinex&#39;s Blog</span>
    <div id="loader"></div>
    <div id="single">
    <div class="scrollbar gradient-bg-rev"></div>
<div id="top" style="display: block;">
    <div class="bar" style="width: 0;"></div>
    <div class="navigation animated fadeIn fast delay-1s">
        <img id="home-icon" class="icon-home" src="/img/favicon.png" alt="" data-url="https://AlphaHinex.github.io">
        <div id="play-icon" title="Play/Pause" class="iconfont icon-play"></div>
        <h3 class="subtitle">【转】解析 MySQL CTE：WITH 与 WITH RECURSIVE</h3>
        <div class="social">
            <!--        <div class="like-icon">-->
            <!--            <a href="javascript:;" class="likeThis active"><span class="icon-like"></span><span class="count">76</span></a>-->
            <!--        </div>-->
            <div>
                <div class="share">
                    
                        <a href="javascript:;" class="iconfont icon-share1"></a>
                        <div class="share-component-cc" data-disabled="facebook,douban,linkedin,diandian,tencent,google"></div>
                    
                </div>
            </div>
        </div>
    </div>
</div>

    <div class="section">
        <div class=article-header-wrapper>
    <div class="article-header">
        <div class="article-cover animated fadeIn" style="
            animation-delay: 600ms;
            animation-duration: 1.2s;
            background-image: 
                radial-gradient(ellipse closest-side, rgba(0, 0, 0, 0.65), #100e17),
                url(/contents/covers/cte-in-mysql.png);">
        </div>
        <div class="else">
            <p class="animated fadeInDown">
                
                <a href="/categories/Database"><b>「
                    </b>DATABASE<b> 」</b></a>
                
                十二月 28, 2025
            </p>
            <h3 class="post-title animated fadeInDown"><a href="/2025/12/28/cte-in-mysql/" title="【转】解析 MySQL CTE：WITH 与 WITH RECURSIVE" class="">【转】解析 MySQL CTE：WITH 与 WITH RECURSIVE</a>
            </h3>
            
            <p class="post-count animated fadeInDown">
                
                <span>
                    <b class="iconfont icon-text2"></b> <i>文章字数</i>
                    9.5k
                </span>
                
                
                <span>
                    <b class="iconfont icon-timer__s"></b> <i>阅读约需</i>
                    9 mins.
                </span>
                
                
                
                <span id="busuanzi_page_pv_container" style="display: flex;">
                    <b class="iconfont icon-read"></b> <i>阅读次数</i>
                    <span id="busuanzi_value_page_pv"></span>
                </span>
                
            </p>
            
            
            <ul class="animated fadeInDown post-tags-list" itemprop="keywords"><li class="animated fadeInDown post-tags-list-item"><a class="animated fadeInDown post-tags-list-link" href="/tags/MySQL/" rel="tag">MySQL</a></li><li class="animated fadeInDown post-tags-list-item"><a class="animated fadeInDown post-tags-list-link" href="/tags/SQL/" rel="tag">SQL</a></li></ul>
            
        </div>
    </div>
</div>

<div class="screen-gradient-after">
    <div class="screen-gradient-content">
        <div class="screen-gradient-content-inside">
            <div class="bold-underline-links screen-gradient-sponsor">
                <p>
                    <span class="animated fadeIn delay-1s"></span>
                </p>
            </div>
        </div>
    </div>
</div>

<div class="article">
    <div class='main'>
        <div class="content markdown animated fadeIn">
            <ul>
<li>原文地址：<a href="https://wyiyi.github.io/amber/2025/12/20/CTE/" target="_blank" rel="noopener">https://wyiyi.github.io/amber/2025/12/20/CTE/</a></li>
</ul>
<p>在开发过程中，发现在 <code>MYSQL</code> 的 <code>Mapper</code> 文件中会用到 <code>WITH</code> 关键字，有一些疑问：为什么要用<code>WITH</code> 和 <code>WITH RECURSIVE</code> ？是什么？有何区别？</p>
<p><img src="https://alphahinex.github.io/contents/covers/cte-in-mysql.png" alt=""></p>
<h2 id="一、-CTE-的含义"><a href="#一、-CTE-的含义" class="headerlink" title="一、 CTE 的含义"></a>一、 CTE 的含义</h2><p><code>MySQL</code> 从 <code>8.0</code> 开始支持 <code>WITH</code> 语法，即：<a href="https://dev.mysql.com/doc/refman/8.0/en/with.html#common-table-expressions" target="_blank" rel="noopener">Common Table Expressions （CTE），公用表表达式</a>。</p>
<p><code>CTE</code> 是一个命名的临时结果集合，仅在单个 <code>SQL</code> 语句（<code>select</code>、<code>insert</code>、<code>update</code> 或 <code>delete</code>）的执行范围内存在。<br>允许用户在单个查询中定义临时的命名结果集，从而提升复杂查询的可读性和结构化程度。</p>
<p><code>CTE</code> 的主要目的是<strong>将复杂的查询逻辑分解为多个简单、可读的步骤</strong>，从而提升 <code>SQL</code> 代码的结构化程度和可维护性。</p>
<p><code>CTE</code> 可以分为两种类型：<code>非递归 CTE</code> 和<code>递归 CTE</code>。</p>
<h2 id="二、-适用场景"><a href="#二、-适用场景" class="headerlink" title="二、 适用场景"></a>二、 适用场景</h2><p>为什么需要使用 <code>WITH</code> ？</p>
<p>假设场景：找出每个学科中，分数高于该科目平均分的学生。</p>
<pre><code class="text">插入8条数据：
INSERT INTO students (name, subject, score) VALUES
-- 数学: 分数 80, 90, 70 -&gt; 平均分 80
(&#39;张三&#39;, &#39;数学&#39;, 90),  -- 高于平均分
(&#39;李四&#39;, &#39;数学&#39;, 80),  -- 等于平均分
(&#39;王五&#39;, &#39;数学&#39;, 70),  -- 低于平均分

-- 物理: 分数 85, 95 -&gt; 平均分 90
(&#39;赵六&#39;, &#39;物理&#39;, 95),  -- 高于平均分
(&#39;孙七&#39;, &#39;物理&#39;, 85),  -- 低于平均分

-- 化学: 分数 88, 92, 100 -&gt; 平均分 93.33
(&#39;周八&#39;, &#39;化学&#39;, 100), -- 高于平均分
(&#39;吴九&#39;, &#39;化学&#39;, 92),  -- 低于平均分
(&#39;郑十&#39;, &#39;化学&#39;, 88);  -- 低于平均分</code></pre>
<p><strong>方式一：不使用 WITH（传统子查询）</strong></p>
<pre><code class="SQL">mysql&gt; SELECT s1.*
FROM students s1
WHERE s1.score &gt; (
   -- 每次都要为 s1 的科目计算一次平均分
   SELECT AVG(s2.score)
   FROM students s2
   WHERE s2.subject = s1.subject
);

+----+------+---------+--------+
| id | name | subject | score  |
+----+------+---------+--------+
|  1 | 张三 | 数学    |  90.00 |
|  4 | 赵六 | 物理    |  95.00 |
|  6 | 周八 | 化学    | 100.00 |
+----+------+---------+--------+
3 rows in set (0.01 sec)</code></pre>
<p><strong>方式二：用 WITH</strong></p>
<pre><code class="SQL">-- 先算好每个科目的平均分
mysql&gt; WITH SubjectAvg AS (
    SELECT subject, AVG(score) AS avg_score
    FROM students
    GROUP BY subject
)
-- 再用这个平均分去筛选学生
SELECT s.*
FROM students s
JOIN SubjectAvg a ON s.subject = a.subject
WHERE s.score &gt; a.avg_score;

+----+------+---------+--------+
| id | name | subject | score  |
+----+------+---------+--------+
|  1 | 张三 | 数学    |  90.00 |
|  4 | 赵六 | 物理    |  95.00 |
|  6 | 周八 | 化学    | 100.00 |
+----+------+---------+--------+
3 rows in set (0.00 sec)</code></pre>
<p>这样看来：</p>
<table>
<thead>
<tr>
<th align="left">特性</th>
<th align="left">方式一</th>
<th align="left">方式二</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><strong>逻辑结果</strong></td>
<td align="left">等价</td>
<td align="left">等价</td>
</tr>
<tr>
<td align="left"><strong>核心思想</strong></td>
<td align="left">对每一行数据，都重新计算一次关联值</td>
<td align="left">先将所有关联值一次性算好，再进行匹配</td>
</tr>
<tr>
<td align="left"><strong>性能</strong></td>
<td align="left">尤其在大数据量下，通常较差（0.01 sec）</td>
<td align="left">性能稳定且可预测，通常极佳（0.00 sec）</td>
</tr>
<tr>
<td align="left"><strong>形象比喻做菜</strong></td>
<td align="left">手忙脚乱，现用现配</td>
<td align="left">专业从容，提前备料</td>
</tr>
</tbody></table>
<h3 id="CTE-可以分为两种类型"><a href="#CTE-可以分为两种类型" class="headerlink" title="CTE 可以分为两种类型"></a>CTE 可以分为两种类型</h3><ol>
<li><p>非递归 <code>CTE</code> 的核心价值在于<strong>提升可读性和模块化</strong>。</p>
<ul>
<li><strong>简化复杂查询：</strong> 将一个需要多步计算的复杂查询分解成多个 <code>CTE</code>，每一步逻辑清晰，易于理解和维护。</li>
<li><strong>代码复用：</strong> 当一个查询中需要多次使用同一个子查询时，可以将其定义为 <code>CTE</code>，避免重复代码。</li>
<li><strong>替代复杂的嵌套子查询：</strong> 用线性的 <code>CTE</code> 链条代替深层嵌套的子查询，使代码结构更扁平。</li>
</ul>
</li>
<li><p>递归 <code>CTE</code> 是处理层级结构或图结构数据的“神器”。</p>
<ul>
<li><strong>组织架构/员工层级查询：</strong> 查询部门及其所有下级部门（包括所有层级的下级部门）。</li>
<li><strong>物料清单分解：</strong> 计算一个产品由哪些零件组成，以及每个零件的成本。</li>
<li><strong>文件系统目录树遍历：</strong> 查询某个目录及其所有子目录下的所有文件。</li>
<li>…</li>
</ul>
</li>
</ol>
<h2 id="三、-非递归-CTE"><a href="#三、-非递归-CTE" class="headerlink" title="三、 非递归 CTE"></a>三、 非递归 CTE</h2><p><code>非递归 CTE</code> 是 <code>CTE</code> 的基础形式，本质上是一个可以复用的子查询。</p>
<h3 id="3-1-语法"><a href="#3-1-语法" class="headerlink" title="3.1 语法"></a>3.1 语法</h3><p>要指定公共表表达式，请使用 <code>WITH</code> 子句，该子句包含一个或多个以逗号分隔的子句。<br>每个子句都提供一个用于生成结果集的子查询，并为该子查询关联一个名称。</p>
<pre><code class="SQL">WITH
    cte1 AS (SELECT a, b FROM table1),
    cte2 AS (SELECT c, d FROM table2)
SELECT b, d FROM cte1 JOIN cte2
WHERE cte1.a = cte2.c;</code></pre>
<p>在使用了 <code>WITH</code> 子句的语句里，可以通过每个 <code>CTE</code> 的名字来查询它所生成的结果集。</p>
<h3 id="3-2-列名定义规则"><a href="#3-2-列名定义规则" class="headerlink" title="3.2 列名定义规则"></a>3.2 列名定义规则</h3><p><code>CTE</code> 的列名可以通过两种方式定义：</p>
<ol>
<li><strong>显式指定列名</strong>：如果 <code>CTE</code> 名称后跟一个带括号的名称列表，那么这些名称就是列名：</li>
</ol>
<pre><code class="SQL">WITH cte (col1, col2) AS
         (SELECT 1, 2
         UNION ALL
         SELECT 3, 4)
SELECT col1, col2
FROM cte;</code></pre>
<ol start="2">
<li><strong>从子查询中继承：</strong> 列名来源于 AS (subquery) 部分中第一个 SELECT 的选择列表：</li>
</ol>
<pre><code class="SQL">WITH cte AS
        (SELECT 1 AS col1, 2 AS col2
         UNION ALL
         SELECT 3, 4)
SELECT col1, col2
FROM cte;</code></pre>
<h3 id="3-3-使用上下文"><a href="#3-3-使用上下文" class="headerlink" title="3.3. 使用上下文"></a>3.3. 使用上下文</h3><p><code>WITH</code> 子句非常灵活，可以在多种 <code>SQL</code> 语句中使用：</p>
<ol>
<li>在 <code>SELECT</code>、<code>UPDATE</code> 和 <code>DELETE</code> 语句的开头：</li>
</ol>
<pre><code class="SQL">WITH ... SELECT ...
WITH ... UPDATE ...
WITH ... DELETE ...</code></pre>
<p><strong>示例：</strong> 更新所有上月活跃但本月不活跃的用户。</p>
<pre><code class="SQL">WITH LastMonthActive AS (
  SELECT user_id FROM activity_log WHERE MONTH(log_date) = MONTH(CURDATE() - INTERVAL 1 MONTH)
),
ThisMonthActive AS (
  SELECT user_id FROM activity_log WHERE MONTH(log_date) = MONTH(CURDATE())
)
UPDATE users
SET status = &#39;dormant&#39;
WHERE user_id IN (SELECT user_id FROM LastMonthActive)
AND user_id NOT IN (SELECT user_id FROM ThisMonthActive);</code></pre>
<ol start="2">
<li>在子查询（包括派生表子查询）的开头：</li>
</ol>
<pre><code class="SQL">SELECT ... WHERE id IN (WITH ... SELECT ...) ...
SELECT * FROM (WITH ... SELECT ...) AS dt ...</code></pre>
<ol start="3">
<li>紧跟在包含 <code>SELECT</code> 语句的 <code>SELECT</code> 之前：</li>
</ol>
<pre><code class="SQL">INSERT ... WITH ... SELECT ...
REPLACE ... WITH ... SELECT ...
CREATE TABLE ... WITH ... SELECT ...
CREATE VIEW ... WITH ... SELECT ...
DECLARE CURSOR ... WITH ... SELECT ...
EXPLAIN ... WITH ... SELECT ...</code></pre>
<p><strong>示例：</strong> 将聚合后的数据插入报表表。</p>
<pre><code class="SQL">WITH DailySales AS (
  SELECT product_id, SUM(amount) AS total_sales
  FROM orders
  WHERE order_date = CURDATE() - INTERVAL 1 DAY
  GROUP BY product_id
)
INSERT INTO sales_report (product_id, sales_amount)
SELECT product_id, total_sales FROM DailySales;</code></pre>
<h2 id="四、-递归-CTE"><a href="#四、-递归-CTE" class="headerlink" title="四、 递归 CTE"></a>四、 递归 CTE</h2><p><code>递归 CTE</code> 是一种特殊的 <code>CTE</code>，它的子查询会引用其自身的名称，从而实现循环遍历。</p>
<h3 id="4-1-语法"><a href="#4-1-语法" class="headerlink" title="4.1 语法"></a>4.1 语法</h3><p>如果一个 <code>CTE</code> 的子查询引用了其自身的名称，那么该 <code>CTE</code> 就是递归的。<br>如果 <code>WITH</code> 子句中的任何 <code>CTE</code> 是递归的，则必须包含 <code>RECURSIVE</code> 关键字。</p>
<p><strong>简单来说：就是一个在它的子查询里引用了自己名字的 CTE。</strong></p>
<pre><code class="SQL">WITH RECURSIVE cte (n) AS
   (
       -- 1. 锚点成员：提供初始结果集，递归的起点
       SELECT 1
       UNION ALL
       -- 2. 递归成员：引用 CTE 自身，不断产生新数据，直到条件不满足
       SELECT n + 1
       FROM cte
       WHERE n &lt; 5)
-- 3. 最终查询：从递归生成的完整结果集中查询数据
SELECT *
FROM cte;</code></pre>
<pre><code class="text">+------+
| n    |
+------+
|    1 |  -- 来自锚点成员
|    2 |  -- 来自递归成员 (1+1)
|    3 |  -- 来自递归成员 (2+1)
|    4 |  -- 来自递归成员 (3+1)
|    5 |  -- 来自递归成员 (4+1)
+------+</code></pre>
<h3 id="4-2-结构解析"><a href="#4-2-结构解析" class="headerlink" title="4.2 结构解析"></a>4.2 结构解析</h3><p>一个递归 <code>CTE</code> 的子查询必须由两部分组成，用 <code>UNION ALL</code> 或 <code>UNION</code> <code>[DISTINCT]</code> 连接：</p>
<ul>
<li><strong>锚点成员：</strong> 执行一次，返回初始结果集。它是递归的“种子”。</li>
<li><strong>递归成员：</strong> 反复执行，直到不再返回任何行。它的 <code>WHERE</code> 子句是递归的终止条件，非常重要，否则会陷入无限循环。</li>
</ul>
<h2 id="五、WITH-与-WITH-RECURSIVE-的区别："><a href="#五、WITH-与-WITH-RECURSIVE-的区别：" class="headerlink" title="五、WITH 与 WITH RECURSIVE 的区别："></a>五、WITH 与 WITH RECURSIVE 的区别：</h2><table>
<thead>
<tr>
<th align="left">特性</th>
<th align="left">WITH (非递归)</th>
<th align="left">WITH RECURSIVE (递归)</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><strong>关键字</strong></td>
<td align="left"><code>WITH</code></td>
<td align="left"><code>WITH RECURSIVE</code></td>
</tr>
<tr>
<td align="left"><strong>自引用</strong></td>
<td align="left"><strong>不允许</strong>，CTE 不能引用自身</td>
<td align="left"><strong>允许</strong>，CTE 必须引用自身以实现递归</td>
</tr>
<tr>
<td align="left"><strong>主要用途</strong></td>
<td align="left">查询逻辑的模块化、代码复用、简化复杂查询</td>
<td align="left">遍历具有层级或父子关系的数据结构</td>
</tr>
<tr>
<td align="left"><strong>结构</strong></td>
<td align="left">一个或多个独立的子查询</td>
<td align="left">必须包含<strong>锚点成员</strong>和<strong>递归成员</strong>两部分</td>
</tr>
<tr>
<td align="left"><strong>性能</strong></td>
<td align="left">通常等同于派生表（子查询），性能相近</td>
<td align="left">可能非常消耗资源，必须有明确的终止条件</td>
</tr>
</tbody></table>

            <!--[if lt IE 9]><script>document.createElement('audio');</script><![endif]-->
            <audio id="audio" loop="1" preload="auto" controls="controls"
                data-autoplay="false">
                <source type="audio/mpeg" src="">
            </audio>
            
            <ul id="audio-list" style="display:none">
                
                
                <li title='0' data-url='/statics/background.mp3'></li>
                
                    
            </ul>
            
            
            
    <div id='gitalk-container' class="comment link"
        data-ae='true'
        data-ci='54f9966b8cc9d2423ffd'
        data-cs='504574e4532bdfa77d3e4091637ff53558408ac2'
        data-r='AlphaHinex.github.io'
        data-o='AlphaHinex'
        data-a='AlphaHinex'
        data-d=''
    >留言</div>


            
            
        </div>
        <div class="sidebar">
            <div class="box animated fadeInRight">
                <div class="subbox">
                    <img src="/img/hinex.jpg" height=300 width=300></img>
                    <p>Alpha Hinex</p>
                    <span>Stay Hungry. Stay Foolish.</span>
                    <dl>
                        <dd><a href="https://github.com/AlphaHinex" target="_blank"><span
                                    class=" iconfont icon-github"></span></a></dd>
                        <dd><a href="/whoami"><span class=" iconfont icon-wechat"></span></a></dd>
                        <dd><a href="" target="_blank"><span
                                    class=" iconfont icon-stack-overflow"></span></a></dd>
                    </dl>
                </div>
                <ul>
                    <li><a href="/">331 <p>文章</p></a></li>
                    <li><a href="/categories">78 <p>分类</p></a></li>
                    <li><a href="/tags">159 <p>标签</p></a></li>
                </ul>
            </div>
            
            
            
            <div class="box sticky animated fadeInRight faster">
                <div id="toc" class="subbox">
                    <h4>目录</h4>
                    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#一、-CTE-的含义"><span class="toc-number">1.</span> <span class="toc-text">一、 CTE 的含义</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#二、-适用场景"><span class="toc-number">2.</span> <span class="toc-text">二、 适用场景</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#CTE-可以分为两种类型"><span class="toc-number">2.1.</span> <span class="toc-text">CTE 可以分为两种类型</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#三、-非递归-CTE"><span class="toc-number">3.</span> <span class="toc-text">三、 非递归 CTE</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-语法"><span class="toc-number">3.1.</span> <span class="toc-text">3.1 语法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-列名定义规则"><span class="toc-number">3.2.</span> <span class="toc-text">3.2 列名定义规则</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-使用上下文"><span class="toc-number">3.3.</span> <span class="toc-text">3.3. 使用上下文</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#四、-递归-CTE"><span class="toc-number">4.</span> <span class="toc-text">四、 递归 CTE</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-语法"><span class="toc-number">4.1.</span> <span class="toc-text">4.1 语法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-结构解析"><span class="toc-number">4.2.</span> <span class="toc-text">4.2 结构解析</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#五、WITH-与-WITH-RECURSIVE-的区别："><span class="toc-number">5.</span> <span class="toc-text">五、WITH 与 WITH RECURSIVE 的区别：</span></a></li></ol>
                </div>
            </div>
            
            
        </div>
    </div>
</div>

    </div>
</div>
    <div id="back-to-top" class="animated fadeIn faster">
        <div class="flow"></div>
        <span class="percentage animated fadeIn faster">0%</span>
        <span class="iconfont icon-top02 animated fadeIn faster"></span>
    </div>
</body>
<footer>
    <p>本站访客数<span id="busuanzi_value_site_uv"></span>人次 / 本站总访问量<span id="busuanzi_value_site_pv"></span>次</p>
    <p class="copyright" id="copyright">
        &copy; 2026
        <span class="gradient-text">
            Alpha Hinex
        </span>.
        Powered by <a href="http://hexo.io/" title="Hexo" target="_blank" rel="noopener">Hexo</a>
        Theme
        <span class="gradient-text">
            <a href="https://github.com/TriDiamond/hexo-theme-obsidian" title="Obsidian" target="_blank" rel="noopener">Obsidian</a>
        </span>
        <small><a href="https://github.com/TriDiamond/hexo-theme-obsidian/blob/master/CHANGELOG.md" title="v1.4.3" target="_blank" rel="noopener">v1.4.3</a></small>
    </p>
</footer>

<script type="text/javascript" src="https://mirrors.sustech.edu.cn/cdnjs/ajax/libs/mathjax/2.7.6/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<script>
  MathJax.Hub.Config({
    "HTML-CSS": {
      preferredFont: "TeX",
      availableFonts: ["STIX", "TeX"],
      linebreaks: {
        automatic: true
      },
      EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50)
    },
    tex2jax: {
      inlineMath: [
        ["$", "$"],
        ["\\(", "\\)"]
      ],
      processEscapes: true,
      ignoreClass: "tex2jax_ignore|dno",
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    TeX: {
      noUndefined: {
        attributes: {
          mathcolor: "red",
          mathbackground: "#FFEEEE",
          mathsize: "90%"
        }
      },
      Macros: {
        href: "{}"
      }
    },
    messageStyle: "none"
  });
</script>
<script>
  function initialMathJax() {
    MathJax.Hub.Queue(function () {
      var all = MathJax.Hub.getAllJax(),
        i;
      // console.log(all);
      for (i = 0; i < all.length; i += 1) {
        console.log(all[i].SourceElement().parentNode)
        all[i].SourceElement().parentNode.className += ' has-jax';
      }
    });
  }

  function reprocessMathJax() {
    if (typeof MathJax !== 'undefined') {
      MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
    }
  }
</script>



    
<link rel="stylesheet" href="/css/gitalk.css">

    
<script src="/js/gitalk.min.js"></script>



<script src="/js/jquery-3.4.1.min.js"></script>
<script src="/js/plugin.js"></script>
<script src="/js/obsidian.js"></script>
<script src="/js/jquery.truncate.js"></script>
<script src="/js/search.js"></script>


<script src="//mirrors.sustech.edu.cn/cdnjs/ajax/libs/typed.js/2.0.10/typed.min.js"></script>


<script src="//mirrors.sustech.edu.cn/cdnjs/ajax/libs/blueimp-md5/2.12.0/js/md5.min.js"></script>


<script src="/js/social-share.min.js"></script>


<script src="https://mirrors.sustech.edu.cn/cdnjs/ajax/libs/codemirror/5.48.4/codemirror.min.js"></script>

    
<script src="//mirrors.sustech.edu.cn/cdnjs/ajax/libs/codemirror/5.48.4/mode/javascript/javascript.min.js"></script>


    
<script src="//mirrors.sustech.edu.cn/cdnjs/ajax/libs/codemirror/5.48.4/mode/css/css.min.js"></script>


    
<script src="//mirrors.sustech.edu.cn/cdnjs/ajax/libs/codemirror/5.48.4/mode/xml/xml.min.js"></script>


    
<script src="//mirrors.sustech.edu.cn/cdnjs/ajax/libs/codemirror/5.48.4/mode/htmlmixed/htmlmixed.min.js"></script>


    
<script src="//mirrors.sustech.edu.cn/cdnjs/ajax/libs/codemirror/5.48.4/mode/clike/clike.min.js"></script>


    
<script src="//mirrors.sustech.edu.cn/cdnjs/ajax/libs/codemirror/5.48.4/mode/php/php.min.js"></script>


    
<script src="//mirrors.sustech.edu.cn/cdnjs/ajax/libs/codemirror/5.48.4/mode/shell/shell.min.js"></script>


    
<script src="//mirrors.sustech.edu.cn/cdnjs/ajax/libs/codemirror/5.48.4/mode/python/python.min.js"></script>


    
<script src="//mirrors.sustech.edu.cn/cdnjs/ajax/libs/codemirror/5.48.4/mode/groovy/groovy.min.js"></script>


    
<script src="//mirrors.sustech.edu.cn/cdnjs/ajax/libs/codemirror/5.48.4/mode/diff/diff.min.js"></script>


    
<script src="//mirrors.sustech.edu.cn/cdnjs/ajax/libs/codemirror/5.48.4/mode/nginx/nginx.min.js"></script>


    
<script src="//mirrors.sustech.edu.cn/cdnjs/ajax/libs/codemirror/5.48.4/mode/properties/properties.min.js"></script>




    
<script src="/js/busuanzi.min.js"></script>

    <script>
        $(document).ready(function () {
            if ($('span[id^="busuanzi_"]').length) {
                initialBusuanzi();
            }
        });
    </script>



<link rel="stylesheet" href="//mirrors.sustech.edu.cn/cdnjs/ajax/libs/photoswipe/4.1.3/photoswipe.min.css">
<link rel="stylesheet" href="//mirrors.sustech.edu.cn/cdnjs/ajax/libs/photoswipe/4.1.3/default-skin/default-skin.min.css">


<script src="//mirrors.sustech.edu.cn/cdnjs/ajax/libs/photoswipe/4.1.3/photoswipe.min.js"></script>
<script src="//mirrors.sustech.edu.cn/cdnjs/ajax/libs/photoswipe/4.1.3/photoswipe-ui-default.min.js"></script>


<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>
    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">
        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>
        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">
            <div class="pswp__top-bar">
                <!--  Controls are self-explanatory. Order can be changed. -->
                <div class="pswp__counter"></div>
                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
                <button class="pswp__button pswp__button--share" title="Share"></button>
                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>
            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>
            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>
            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>
            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>
        </div>
    </div>
</div>



    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="//www.googletagmanager.com/gtag/js?id=UA-69084811-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-69084811-1');
    </script>





<script>
    function initialTyped () {
        var typedTextEl = $('.typed-text');
        if (typedTextEl && typedTextEl.length > 0) {
            var typed = new Typed('.typed-text', {
                strings: ["Stay Hungry. Stay Foolish.", "常与同好争高下，莫与傻子论短长"],
                typeSpeed: 90,
                loop: true,
                loopCount: Infinity,
                backSpeed: 20,
            });
        }
    }

    if ($('.article-header') && $('.article-header').length) {
        $(document).ready(function () {
            initialTyped();
        });
    }
</script>




</html>
