
<!DOCTYPE html>
<html lang="zh-CN" class="loading">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>玩转 @ConditionalOnMissingBean - Alpha Hinex&#39;s Blog</title>
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="google" content="notranslate" />
    <meta name="keywords" content="Java, JavaScript, Spring, Html5, NoSQL, Docker, DevOps,ConditionalOnMissingBean, K8s"> 
    <meta name="description" content="在 男人，不能说不行！ 中，留了两个问题：

为什么名为 testServiceImpl 的 Bean 会被注册？
为什么无法注入 TestService 的实例？

先从可运行环境 https:/,"> 
    <meta name="author" content="Alpha Hinex"> 

    <meta name="msvalidate.01" content="D769824B4D44C14A4C777A6EC4E898FC"> 
    <meta name="baidu-site-verification" content="TimiEK4Y9V"> 
    <meta name="google-site-verification" content="B-WME81HWSnMIkZZxcxv7bVI6yjbpAFKvifi2X-EkzQ"> 

    <link rel="alternative" href="atom.xml" title="Alpha Hinex&#39;s Blog" type="application/atom+xml"> 
    <link rel="icon" href="/img/favicon.png"> 
    <link href="https://fonts.loli.net/css?family=Roboto+Mono|Rubik&display=swap" rel="stylesheet">
    
<link rel="stylesheet" href="//at.alicdn.com/t/font_1429596_nzgqgvnmkjb.css">

    
<link rel="stylesheet" href="//mirrors.sustech.edu.cn/cdnjs/ajax/libs/animate.css/3.7.2/animate.min.css">

    
<link rel="stylesheet" href="/css/share.min.css">

    
<link rel="stylesheet" href="//mirrors.sustech.edu.cn/cdnjs/ajax/libs/codemirror/5.48.4/codemirror.min.css">

    
<link rel="stylesheet" href="//mirrors.sustech.edu.cn/cdnjs/ajax/libs/codemirror/5.48.4/theme/dracula.css">

    
<link rel="stylesheet" href="/css/obsidian.css">

    
<link rel="stylesheet" href="/css/ball-atom.min.css">

<meta name="generator" content="Hexo 4.2.1"></head>


<body class="loading">
    <div class="loader">
        <div class="la-ball-atom la-2x">
            <div></div>
            <div></div>
            <div></div>
            <div></div>
        </div>
    </div>
    <span id="config-title" style="display:none">Alpha Hinex&#39;s Blog</span>
    <div id="loader"></div>
    <div id="single">
    <div class="scrollbar gradient-bg-rev"></div>
<div id="top" style="display: block;">
    <div class="bar" style="width: 0;"></div>
    <div class="navigation animated fadeIn fast delay-1s">
        <img id="home-icon" class="icon-home" src="/img/favicon.png" alt="" data-url="https://AlphaHinex.github.io">
        <div id="play-icon" title="Play/Pause" class="iconfont icon-play"></div>
        <h3 class="subtitle">玩转 @ConditionalOnMissingBean</h3>
        <div class="social">
            <!--        <div class="like-icon">-->
            <!--            <a href="javascript:;" class="likeThis active"><span class="icon-like"></span><span class="count">76</span></a>-->
            <!--        </div>-->
            <div>
                <div class="share">
                    
                        <a href="javascript:;" class="iconfont icon-share1"></a>
                        <div class="share-component-cc" data-disabled="facebook,douban,linkedin,diandian,tencent,google"></div>
                    
                </div>
            </div>
        </div>
    </div>
</div>

    <div class="section">
        <div class=article-header-wrapper>
    <div class="article-header">
        <div class="article-cover animated fadeIn" style="
            animation-delay: 600ms;
            animation-duration: 1.2s;
            background-image: 
                radial-gradient(ellipse closest-side, rgba(0, 0, 0, 0.65), #100e17),
                url(/contents/covers/conditional-on-missing-bean.jpg);">
        </div>
        <div class="else">
            <p class="animated fadeInDown">
                
                <a href="/categories/Spring"><b>「
                    </b>SPRING<b> 」</b></a>
                
                六月 27, 2021
            </p>
            <h3 class="post-title animated fadeInDown"><a href="/2021/06/27/conditional-on-missing-bean/" title="玩转 @ConditionalOnMissingBean" class="">玩转 @ConditionalOnMissingBean</a>
            </h3>
            
            <p class="post-count animated fadeInDown">
                
                <span>
                    <b class="iconfont icon-text2"></b> <i>文章字数</i>
                    7k
                </span>
                
                
                <span>
                    <b class="iconfont icon-timer__s"></b> <i>阅读约需</i>
                    6 mins.
                </span>
                
                
                
                <span id="busuanzi_page_pv_container" style="display: flex;">
                    <b class="iconfont icon-read"></b> <i>阅读次数</i>
                    <span id="busuanzi_value_page_pv"></span>
                </span>
                
            </p>
            
            
            <ul class="animated fadeInDown post-tags-list" itemprop="keywords"><li class="animated fadeInDown post-tags-list-item"><a class="animated fadeInDown post-tags-list-link" href="/tags/Java/" rel="tag">Java</a></li><li class="animated fadeInDown post-tags-list-item"><a class="animated fadeInDown post-tags-list-link" href="/tags/Spring/" rel="tag">Spring</a></li><li class="animated fadeInDown post-tags-list-item"><a class="animated fadeInDown post-tags-list-link" href="/tags/Spring-Boot/" rel="tag">Spring Boot</a></li></ul>
            
        </div>
    </div>
</div>

<div class="screen-gradient-after">
    <div class="screen-gradient-content">
        <div class="screen-gradient-content-inside">
            <div class="bold-underline-links screen-gradient-sponsor">
                <p>
                    <span class="animated fadeIn delay-1s"></span>
                </p>
            </div>
        </div>
    </div>
</div>

<div class="article">
    <div class='main'>
        <div class="content markdown animated fadeIn">
            <p>在 <a href="https://alphahinex.github.io/2021/06/20/to-father/">男人，不能说不行！</a> 中，留了两个问题：</p>
<ol>
<li>为什么名为 <code>testServiceImpl</code> 的 Bean 会被注册？</li>
<li>为什么无法注入 TestService 的实例？</li>
</ol>
<p>先从可运行环境 <a href="https://github.com/AlphaHinex/conditional-on-missing-bean-demo" target="_blank" rel="noopener">https://github.com/AlphaHinex/conditional-on-missing-bean-demo</a> 看下结果。</p>
<p>在测试用例中，通过 <code>@Autowired</code> 注解注入了 TestService，但调用时，报了空指针异常，说明容器中没有 TestService 类型的实例。</p>
<p>那么是 <code>@ConditionalOnMissingBean</code> 不行吗？</p>
<p>看下 bean 的定义：</p>
<pre><code class="java">@Service
@ConditionalOnMissingBean(TestService.class)
public class TestServiceImpl implements TestService</code></pre>
<h2 id="debug"><a href="#debug" class="headerlink" title="debug"></a>debug</h2><p>打开 <code>org.springframework</code> 的 <code>debug</code> 级别日志，可以看到：</p>
<pre><code class="text">   TestServiceImpl:
      Did not match:
         - @ConditionalOnMissingBean (types: com.example.demo.service.TestService; SearchStrategy: all) found beans of type &#39;com.example.demo.service.TestService&#39; testServiceImpl (OnBeanCondition)</code></pre>
<p><code>@ConditionalOnMissingBean</code> 没有生效的原因，是因为其条件没有满足，即 <code>found beans of type &#39;com.example.demo.service.TestService&#39; testServiceImpl</code>。</p>
<p>这就矛盾了啊：</p>
<ol>
<li>因为找到了 TestService 类型的 bean，所以没有注册 TestServiceImpl 这个 bean，但找到的那个 bean 的名称，是 testServiceImpl ，也就是 —— TestServiceImpl 自己！</li>
<li>既然 <code>@ConditionalOnMissingBean</code> 没有生效，说明有这个 bean，但注入的时候还注入了个 null！</li>
</ol>
<h2 id="一探究竟"><a href="#一探究竟" class="headerlink" title="一探究竟"></a>一探究竟</h2><p>先来看下 <a href="https://github.com/spring-projects/spring-boot/blob/v2.5.1/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/condition/ConditionalOnMissingBean.java#L53-L56" target="_blank" rel="noopener">ConditionalOnMissingBean</a> 中的注释文字：</p>
<blockquote>
<p>The condition can only match the bean definitions that have been processed by the application context so far and, as such, it is strongly recommended to use this condition on auto-configuration classes only. If a candidate bean may be created by another auto-configuration, make sure that the one using this condition runs after.</p>
</blockquote>
<p>可以得出几个要点：</p>
<ol>
<li>强烈建议仅在自动配置类上使用此注解</li>
<li>这个条件仅能匹配已经被当前的应用上下文处理过的 bean 定义</li>
<li>如果候选 bean 是被其他配置类创建的，需确保这个条件在其后运行</li>
</ol>
<p>所以一般我们很少见到本例中这样直接在 <code>@Service</code> 类上使用 <code>@ConditionalOnMissingBean</code> 的情况，大多数都是如源码中建议所示：</p>
<pre><code class="java">@Configuration
public class MyAutoConfiguration {

    @ConditionalOnMissingBean
    @Bean
    public MyService myService() {
        ...
    }

}</code></pre>
<p>虽说不建议，但也不是不行。从日志中也可以看出，这个条件确实被运行了，只不过并未满足条件。</p>
<p>继续往下看，条件进行计算时，会从当时已经处理过的 bean 定义中进行匹配，也就是说，TestServiceImpl 这个 bean 在进行条件判断时已经注册到 Spring 容器中了。</p>
<p>在 Spring 中，Bean 被抽象为 <a href="https://github.com/spring-projects/spring-framework/blob/v5.3.8/spring-beans/src/main/java/org/springframework/beans/factory/config/BeanDefinition.java" target="_blank" rel="noopener">BeanDefinition</a>，注册到 <a href="https://github.com/spring-projects/spring-framework/blob/v5.3.8/spring-beans/src/main/java/org/springframework/beans/factory/support/BeanDefinitionRegistry.java" target="_blank" rel="noopener">BeanDefinitionRegistry</a> 中。</p>
<p>注册时，通过 BeanDefinitionRegistry 中的 <code>registerBeanDefinition</code> 方法，将 bean 以 beanName 为 key，beanDefinition 为 value，注册到 BeanDefinitionRegistry 具体实现类的一个 Map 中。</p>
<pre><code class="java">void registerBeanDefinition(String beanName, BeanDefinition beanDefinition)
        throws BeanDefinitionStoreException;</code></pre>
<p>在 <a href="https://github.com/spring-projects/spring-framework/blob/v5.3.8/spring-beans/src/main/java/org/springframework/beans/factory/support/BeanDefinitionReaderUtils.java#L164" target="_blank" rel="noopener">BeanDefinitionReaderUtils.java#L164</a> 打断点，可以观察到 bean 被注册的情况。</p>
<p>可以看到 <code>testServiceImpl</code> 这个 bean，被根据启动类获得到的 basePackages 扫描到了，进而注册到了容器中。</p>
<p>之后会从 ConfigurationClassParser 中获得所有用户自定义的配置类：</p>
<pre><code class="java">Set&lt;ConfigurationClass&gt; configClasses = new LinkedHashSet&lt;&gt;(parser.getConfigurationClasses());</code></pre>
<p>再由 ConfigurationClassBeanDefinitionReader 读取配置类中的 bean 定义：</p>
<pre><code class="java">this.reader.loadBeanDefinitions(configClasses);</code></pre>
<p>ConfigurationClassBeanDefinitionReader 在读取 bean 定义时，会使用 TrackedConditionEvaluator 先进行是否要跳过这个 bean 的判断，如果需要跳过，则从 registry 中将这个 bean 移除：</p>
<pre><code class="java">if (trackedConditionEvaluator.shouldSkip(configClass)) {
    String beanName = configClass.getBeanName();
    if (StringUtils.hasLength(beanName) &amp;&amp; this.registry.containsBeanDefinition(beanName)) {
        this.registry.removeBeanDefinition(beanName);
    }
    this.importRegistry.removeImportingClass(configClass.getMetadata().getClassName());
    return;
}</code></pre>
<p>TrackedConditionEvaluator 的 shouldSkip 方法，会使用 ConditionEvaluator 进行条件计算：</p>
<pre><code class="java">skip = conditionEvaluator.shouldSkip(configClass.getMetadata(), ConfigurationPhase.REGISTER_BEAN);</code></pre>
<p>而 ConditionEvaluator 是使用 BeanDefinitionRegistry 构造的：</p>
<pre><code class="java">public ConditionEvaluator(@Nullable BeanDefinitionRegistry registry,
            @Nullable Environment environment, @Nullable ResourceLoader resourceLoader)</code></pre>
<p>所以在进行条件计算时，registry 中有 <code>testServiceImpl</code> 的定义，此时 <code>@ConditionalOnMissingBean(TestService.class)</code> 条件不满足，故 skip 为 true，<code>testServiceImpl</code> 结束了其短暂的生命周期，被从 registry 中移除掉了，这也就解释了在测试用例中，无法再 <code>@Autowired</code> 进来 <code>TestService</code> 实例的原因。</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>再回顾一下 <code>@ConditionalOnMissingBean</code> 的三个要点：</p>
<h3 id="强烈建议仅在自动配置类上使用此注解"><a href="#强烈建议仅在自动配置类上使用此注解" class="headerlink" title="强烈建议仅在自动配置类上使用此注解"></a>强烈建议仅在自动配置类上使用此注解</h3><p>本例中，如果是以如下方式定义这个 bean，则不会出现本例中条件失效，无法从容器中获取此 bean 的情况：</p>
<pre><code class="java">@Bean
@ConditionalOnMissingBean(TestService.class)
public TestService testService() {
    return new TestService() {
        @Override
        public String helloWorld() {
            return this.getClass().getName() + &quot; says hello world&quot;;
        }
    };
}</code></pre>
<h3 id="这个条件仅能匹配已经被当前的应用上下文处理过的-bean-定义"><a href="#这个条件仅能匹配已经被当前的应用上下文处理过的-bean-定义" class="headerlink" title="这个条件仅能匹配已经被当前的应用上下文处理过的 bean 定义"></a>这个条件仅能匹配已经被当前的应用上下文处理过的 bean 定义</h3><p>因为会先扫描 basePackages 中的 bean，再读取配置类中的 bean，条件的计算是在二者之间，所以上面两种定义 TestService bean 的方式，会得到两个不同的结果。</p>
<h3 id="如果候选-bean-是被其他配置类创建的，需确保这个条件在其后运行"><a href="#如果候选-bean-是被其他配置类创建的，需确保这个条件在其后运行" class="headerlink" title="如果候选 bean 是被其他配置类创建的，需确保这个条件在其后运行"></a>如果候选 bean 是被其他配置类创建的，需确保这个条件在其后运行</h3><p>如果已经在 A 配置类中定义了 TestService bean，在 B 配置类中要使用 TestService 进行条件判断，则需保证 B 的配置类在 A 之后被处理，此时可以使用 <code>@AutoConfigureBefore</code> 或 <code>@AutoConfigureOrder</code> 进行配置类先后顺序的控制。</p>

            <!--[if lt IE 9]><script>document.createElement('audio');</script><![endif]-->
            <audio id="audio" loop="1" preload="auto" controls="controls"
                data-autoplay="false">
                <source type="audio/mpeg" src="">
            </audio>
            
            <ul id="audio-list" style="display:none">
                
                
                <li title='0' data-url='/statics/background.mp3'></li>
                
                    
            </ul>
            
            
            
    <div id='gitalk-container' class="comment link"
        data-ae='true'
        data-ci='54f9966b8cc9d2423ffd'
        data-cs='504574e4532bdfa77d3e4091637ff53558408ac2'
        data-r='AlphaHinex.github.io'
        data-o='AlphaHinex'
        data-a='AlphaHinex'
        data-d=''
    >留言</div>


            
            
        </div>
        <div class="sidebar">
            <div class="box animated fadeInRight">
                <div class="subbox">
                    <img src="/img/hinex.jpg" height=300 width=300></img>
                    <p>Alpha Hinex</p>
                    <span>Stay Hungry. Stay Foolish.</span>
                    <dl>
                        <dd><a href="https://github.com/AlphaHinex" target="_blank"><span
                                    class=" iconfont icon-github"></span></a></dd>
                        <dd><a href="/whoami"><span class=" iconfont icon-wechat"></span></a></dd>
                        <dd><a href="" target="_blank"><span
                                    class=" iconfont icon-stack-overflow"></span></a></dd>
                    </dl>
                </div>
                <ul>
                    <li><a href="/">314 <p>文章</p></a></li>
                    <li><a href="/categories">76 <p>分类</p></a></li>
                    <li><a href="/tags">153 <p>标签</p></a></li>
                </ul>
            </div>
            
            
            
            <div class="box sticky animated fadeInRight faster">
                <div id="toc" class="subbox">
                    <h4>目录</h4>
                    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#debug"><span class="toc-number">1.</span> <span class="toc-text">debug</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#一探究竟"><span class="toc-number">2.</span> <span class="toc-text">一探究竟</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#总结"><span class="toc-number">3.</span> <span class="toc-text">总结</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#强烈建议仅在自动配置类上使用此注解"><span class="toc-number">3.1.</span> <span class="toc-text">强烈建议仅在自动配置类上使用此注解</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#这个条件仅能匹配已经被当前的应用上下文处理过的-bean-定义"><span class="toc-number">3.2.</span> <span class="toc-text">这个条件仅能匹配已经被当前的应用上下文处理过的 bean 定义</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#如果候选-bean-是被其他配置类创建的，需确保这个条件在其后运行"><span class="toc-number">3.3.</span> <span class="toc-text">如果候选 bean 是被其他配置类创建的，需确保这个条件在其后运行</span></a></li></ol></li></ol>
                </div>
            </div>
            
            
        </div>
    </div>
</div>

    </div>
</div>
    <div id="back-to-top" class="animated fadeIn faster">
        <div class="flow"></div>
        <span class="percentage animated fadeIn faster">0%</span>
        <span class="iconfont icon-top02 animated fadeIn faster"></span>
    </div>
</body>
<footer>
    <p>本站访客数<span id="busuanzi_value_site_uv"></span>人次 / 本站总访问量<span id="busuanzi_value_site_pv"></span>次</p>
    <p class="copyright" id="copyright">
        &copy; 2025
        <span class="gradient-text">
            Alpha Hinex
        </span>.
        Powered by <a href="http://hexo.io/" title="Hexo" target="_blank" rel="noopener">Hexo</a>
        Theme
        <span class="gradient-text">
            <a href="https://github.com/TriDiamond/hexo-theme-obsidian" title="Obsidian" target="_blank" rel="noopener">Obsidian</a>
        </span>
        <small><a href="https://github.com/TriDiamond/hexo-theme-obsidian/blob/master/CHANGELOG.md" title="v1.4.3" target="_blank" rel="noopener">v1.4.3</a></small>
    </p>
</footer>

<script type="text/javascript" src="https://mirrors.sustech.edu.cn/cdnjs/ajax/libs/mathjax/2.7.6/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<script>
  MathJax.Hub.Config({
    "HTML-CSS": {
      preferredFont: "TeX",
      availableFonts: ["STIX", "TeX"],
      linebreaks: {
        automatic: true
      },
      EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50)
    },
    tex2jax: {
      inlineMath: [
        ["$", "$"],
        ["\\(", "\\)"]
      ],
      processEscapes: true,
      ignoreClass: "tex2jax_ignore|dno",
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    TeX: {
      noUndefined: {
        attributes: {
          mathcolor: "red",
          mathbackground: "#FFEEEE",
          mathsize: "90%"
        }
      },
      Macros: {
        href: "{}"
      }
    },
    messageStyle: "none"
  });
</script>
<script>
  function initialMathJax() {
    MathJax.Hub.Queue(function () {
      var all = MathJax.Hub.getAllJax(),
        i;
      // console.log(all);
      for (i = 0; i < all.length; i += 1) {
        console.log(all[i].SourceElement().parentNode)
        all[i].SourceElement().parentNode.className += ' has-jax';
      }
    });
  }

  function reprocessMathJax() {
    if (typeof MathJax !== 'undefined') {
      MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
    }
  }
</script>



    
<link rel="stylesheet" href="/css/gitalk.css">

    
<script src="/js/gitalk.min.js"></script>



<script src="/js/jquery-3.4.1.min.js"></script>
<script src="/js/plugin.js"></script>
<script src="/js/obsidian.js"></script>
<script src="/js/jquery.truncate.js"></script>
<script src="/js/search.js"></script>


<script src="//mirrors.sustech.edu.cn/cdnjs/ajax/libs/typed.js/2.0.10/typed.min.js"></script>


<script src="//mirrors.sustech.edu.cn/cdnjs/ajax/libs/blueimp-md5/2.12.0/js/md5.min.js"></script>


<script src="/js/social-share.min.js"></script>


<script src="https://mirrors.sustech.edu.cn/cdnjs/ajax/libs/codemirror/5.48.4/codemirror.min.js"></script>

    
<script src="//mirrors.sustech.edu.cn/cdnjs/ajax/libs/codemirror/5.48.4/mode/javascript/javascript.min.js"></script>


    
<script src="//mirrors.sustech.edu.cn/cdnjs/ajax/libs/codemirror/5.48.4/mode/css/css.min.js"></script>


    
<script src="//mirrors.sustech.edu.cn/cdnjs/ajax/libs/codemirror/5.48.4/mode/xml/xml.min.js"></script>


    
<script src="//mirrors.sustech.edu.cn/cdnjs/ajax/libs/codemirror/5.48.4/mode/htmlmixed/htmlmixed.min.js"></script>


    
<script src="//mirrors.sustech.edu.cn/cdnjs/ajax/libs/codemirror/5.48.4/mode/clike/clike.min.js"></script>


    
<script src="//mirrors.sustech.edu.cn/cdnjs/ajax/libs/codemirror/5.48.4/mode/php/php.min.js"></script>


    
<script src="//mirrors.sustech.edu.cn/cdnjs/ajax/libs/codemirror/5.48.4/mode/shell/shell.min.js"></script>


    
<script src="//mirrors.sustech.edu.cn/cdnjs/ajax/libs/codemirror/5.48.4/mode/python/python.min.js"></script>


    
<script src="//mirrors.sustech.edu.cn/cdnjs/ajax/libs/codemirror/5.48.4/mode/groovy/groovy.min.js"></script>


    
<script src="//mirrors.sustech.edu.cn/cdnjs/ajax/libs/codemirror/5.48.4/mode/diff/diff.min.js"></script>


    
<script src="//mirrors.sustech.edu.cn/cdnjs/ajax/libs/codemirror/5.48.4/mode/nginx/nginx.min.js"></script>


    
<script src="//mirrors.sustech.edu.cn/cdnjs/ajax/libs/codemirror/5.48.4/mode/properties/properties.min.js"></script>




    
<script src="/js/busuanzi.min.js"></script>

    <script>
        $(document).ready(function () {
            if ($('span[id^="busuanzi_"]').length) {
                initialBusuanzi();
            }
        });
    </script>



<link rel="stylesheet" href="//mirrors.sustech.edu.cn/cdnjs/ajax/libs/photoswipe/4.1.3/photoswipe.min.css">
<link rel="stylesheet" href="//mirrors.sustech.edu.cn/cdnjs/ajax/libs/photoswipe/4.1.3/default-skin/default-skin.min.css">


<script src="//mirrors.sustech.edu.cn/cdnjs/ajax/libs/photoswipe/4.1.3/photoswipe.min.js"></script>
<script src="//mirrors.sustech.edu.cn/cdnjs/ajax/libs/photoswipe/4.1.3/photoswipe-ui-default.min.js"></script>


<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>
    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">
        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>
        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">
            <div class="pswp__top-bar">
                <!--  Controls are self-explanatory. Order can be changed. -->
                <div class="pswp__counter"></div>
                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
                <button class="pswp__button pswp__button--share" title="Share"></button>
                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>
            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>
            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>
            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>
            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>
        </div>
    </div>
</div>



    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="//www.googletagmanager.com/gtag/js?id=UA-69084811-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-69084811-1');
    </script>





<script>
    function initialTyped () {
        var typedTextEl = $('.typed-text');
        if (typedTextEl && typedTextEl.length > 0) {
            var typed = new Typed('.typed-text', {
                strings: ["Stay Hungry. Stay Foolish.", "常与同好争高下，莫与傻子论短长"],
                typeSpeed: 90,
                loop: true,
                loopCount: Infinity,
                backSpeed: 20,
            });
        }
    }

    if ($('.article-header') && $('.article-header').length) {
        $(document).ready(function () {
            initialTyped();
        });
    }
</script>




</html>
