
<!DOCTYPE html>
<html lang="zh-CN" class="loading">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>谁动了我的异常？ - Alpha Hinex&#39;s Blog</title>
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="google" content="notranslate" />
    <meta name="keywords" content="Java, JavaScript, Spring, Html5, NoSQL, Docker, DevOps,Java, Spring, AOP, Proxy, CGLIB, UndeclaredThrowableException, Checked Exception, Unchecked Exception"> 
    <meta name="description" content="场景描述通常来讲，为方便开发，我们会对异常进行统一的处理。会定义一个异常基类，针对基于这个基类的自定义异常进行统一处理。
当异常基类为检查型异常（Checked Exception）时，如果自定义异,"> 
    <meta name="author" content="Alpha Hinex"> 

    <meta name="msvalidate.01" content="D769824B4D44C14A4C777A6EC4E898FC"> 
    <meta name="baidu-site-verification" content="TimiEK4Y9V"> 
    <meta name="google-site-verification" content="B-WME81HWSnMIkZZxcxv7bVI6yjbpAFKvifi2X-EkzQ"> 

    <link rel="alternative" href="atom.xml" title="Alpha Hinex&#39;s Blog" type="application/atom+xml"> 
    <link rel="icon" href="/img/favicon.png"> 
    <link href="https://fonts.loli.net/css?family=Roboto+Mono|Rubik&display=swap" rel="stylesheet">
    
<link rel="stylesheet" href="//at.alicdn.com/t/font_1429596_nzgqgvnmkjb.css">

    
<link rel="stylesheet" href="//mirrors.sustech.edu.cn/cdnjs/ajax/libs/animate.css/3.7.2/animate.min.css">

    
<link rel="stylesheet" href="/css/share.min.css">

    
<link rel="stylesheet" href="//mirrors.sustech.edu.cn/cdnjs/ajax/libs/codemirror/5.48.4/codemirror.min.css">

    
<link rel="stylesheet" href="//mirrors.sustech.edu.cn/cdnjs/ajax/libs/codemirror/5.48.4/theme/dracula.css">

    
<link rel="stylesheet" href="/css/obsidian.css">

    
<link rel="stylesheet" href="/css/ball-atom.min.css">

<meta name="generator" content="Hexo 4.2.1"></head>


<body class="loading">
    <div class="loader">
        <div class="la-ball-atom la-2x">
            <div></div>
            <div></div>
            <div></div>
            <div></div>
        </div>
    </div>
    <span id="config-title" style="display:none">Alpha Hinex&#39;s Blog</span>
    <div id="loader"></div>
    <div id="single">
    <div class="scrollbar gradient-bg-rev"></div>
<div id="top" style="display: block;">
    <div class="bar" style="width: 0;"></div>
    <div class="navigation animated fadeIn fast delay-1s">
        <img id="home-icon" class="icon-home" src="/img/favicon.png" alt="" data-url="https://AlphaHinex.github.io">
        <div id="play-icon" title="Play/Pause" class="iconfont icon-play"></div>
        <h3 class="subtitle">谁动了我的异常？</h3>
        <div class="social">
            <!--        <div class="like-icon">-->
            <!--            <a href="javascript:;" class="likeThis active"><span class="icon-like"></span><span class="count">76</span></a>-->
            <!--        </div>-->
            <div>
                <div class="share">
                    
                        <a href="javascript:;" class="iconfont icon-share1"></a>
                        <div class="share-component-cc" data-disabled="facebook,douban,linkedin,diandian,tencent,google"></div>
                    
                </div>
            </div>
        </div>
    </div>
</div>

    <div class="section">
        <div class=article-header-wrapper>
    <div class="article-header">
        <div class="article-cover animated fadeIn" style="
            animation-delay: 600ms;
            animation-duration: 1.2s;
            background-image: 
                radial-gradient(ellipse closest-side, rgba(0, 0, 0, 0.65), #100e17),
                url(/contents/covers/undeclared-throwable-exception.jpg);">
        </div>
        <div class="else">
            <p class="animated fadeInDown">
                
                <a href="/categories/Spring"><b>「
                    </b>SPRING<b> 」</b></a>
                
                六月 26, 2020
            </p>
            <h3 class="post-title animated fadeInDown"><a href="/2020/06/26/undeclared-throwable-exception/" title="谁动了我的异常？" class="">谁动了我的异常？</a>
            </h3>
            
            <p class="post-count animated fadeInDown">
                
                <span>
                    <b class="iconfont icon-text2"></b> <i>文章字数</i>
                    11k
                </span>
                
                
                <span>
                    <b class="iconfont icon-timer__s"></b> <i>阅读约需</i>
                    10 mins.
                </span>
                
                
                
                <span id="busuanzi_page_pv_container" style="display: flex;">
                    <b class="iconfont icon-read"></b> <i>阅读次数</i>
                    <span id="busuanzi_value_page_pv"></span>
                </span>
                
            </p>
            
            
            <ul class="animated fadeInDown post-tags-list" itemprop="keywords"><li class="animated fadeInDown post-tags-list-item"><a class="animated fadeInDown post-tags-list-link" href="/tags/Java/" rel="tag">Java</a></li><li class="animated fadeInDown post-tags-list-item"><a class="animated fadeInDown post-tags-list-link" href="/tags/Spring/" rel="tag">Spring</a></li></ul>
            
        </div>
    </div>
</div>

<div class="screen-gradient-after">
    <div class="screen-gradient-content">
        <div class="screen-gradient-content-inside">
            <div class="bold-underline-links screen-gradient-sponsor">
                <p>
                    <span class="animated fadeIn delay-1s"></span>
                </p>
            </div>
        </div>
    </div>
</div>

<div class="article">
    <div class='main'>
        <div class="content markdown animated fadeIn">
            <h2 id="场景描述"><a href="#场景描述" class="headerlink" title="场景描述"></a>场景描述</h2><p>通常来讲，为方便开发，我们会对异常进行统一的处理。会定义一个异常基类，针对基于这个基类的自定义异常进行统一处理。</p>
<p>当异常基类为检查型异常（Checked Exception）时，如果自定义异常是通过切面等代理抛出的，被代理的方法本身并未抛出且也未声明此异常时，就会遇到这个问题：</p>
<p>统一异常处理方法中，捕获到的异常，已不是代理类中抛出的自定义异常，而是一个将自定义异常包装在内的 <code>java.lang.reflect.UndeclaredThrowableException</code>。</p>
<p>那么为什么会这样呢？</p>
<h2 id="追根溯源"><a href="#追根溯源" class="headerlink" title="追根溯源"></a>追根溯源</h2><p>以使用 <a href="https://github.com/spring-projects/spring-framework/tree/v5.0.13.RELEASE" target="_blank" rel="noopener">Spring Framework v5.0.13.RELEASE</a> 及切面场景为例。</p>
<p>Spring 文档中关于 <a href="https://docs.spring.io/spring/docs/5.0.13.RELEASE/spring-framework-reference/core.html#aop-introduction-proxies" target="_blank" rel="noopener">AOP 代理</a> 的描述如下：</p>
<pre><code class="doc">5.1.3. AOP Proxies
Spring AOP defaults to using standard JDK dynamic proxies for AOP proxies. This enables any interface (or set of interfaces) to be proxied.

Spring AOP can also use CGLIB proxies. This is necessary to proxy classes rather than interfaces. CGLIB is used by default if a business object does not implement an interface. As it is good practice to program to interfaces rather than classes; business classes normally will implement one or more business interfaces. It is possible to force the use of CGLIB, in those (hopefully rare) cases where you need to advise a method that is not declared on an interface, or where you need to pass a proxied object to a method as a concrete type.

It is important to grasp the fact that Spring AOP is proxy-based. See Understanding AOP proxies for a thorough examination of exactly what this implementation detail actually means.</code></pre>
<p>几个重点：</p>
<ol>
<li>Spring AOP 是基于代理来实现的。</li>
<li>Spring AOP 默认使用 JDK 动态代理来为切面创建代理。这使得所有接口的实现类都可以被代理。</li>
<li>Spring AOP 也可以使用 CGLIB 创建代理。当一个类未实现任何接口时，会默认使用 CGLIB 的方式创建代理。也可以强制使用 CGLIB 进行代理。</li>
</ol>
<p>在 <a href="https://github.com/spring-projects/spring-framework/blob/v5.0.13.RELEASE/spring-aop/src/main/java/org/springframework/aop/framework/DefaultAopProxyFactory.java" target="_blank" rel="noopener">DefaultAopProxyFactory</a> 中可以看到对应的逻辑：</p>
<pre><code class="javadoc">* &lt;p&gt;Creates a CGLIB proxy if one the following is true for a given
* {@link AdvisedSupport} instance:
* &lt;ul&gt;
* &lt;li&gt;the {@code optimize} flag is set
* &lt;li&gt;the {@code proxyTargetClass} flag is set
* &lt;li&gt;no proxy interfaces have been specified
* &lt;/ul&gt;
*
* &lt;p&gt;In general, specify {@code proxyTargetClass} to enforce a CGLIB proxy,
* or specify one or more interfaces to use a JDK dynamic proxy.</code></pre>
<pre><code class="java">@Override
public AopProxy createAopProxy(AdvisedSupport config) throws AopConfigException {
  if (config.isOptimize() || config.isProxyTargetClass() || hasNoUserSuppliedProxyInterfaces(config)) {
    Class&lt;?&gt; targetClass = config.getTargetClass();
    if (targetClass == null) {
      throw new AopConfigException(&quot;TargetSource cannot determine target class: &quot; +
          &quot;Either an interface or a target is required for proxy creation.&quot;);
    }
    if (targetClass.isInterface() || Proxy.isProxyClass(targetClass)) {
      return new JdkDynamicAopProxy(config);
    }
    return new ObjenesisCglibAopProxy(config);
  }
  else {
    return new JdkDynamicAopProxy(config);
  }
}</code></pre>
<p>使用 <code>ObjenesisCglibAopProxy</code> 创建代理时，会调用 <a href="https://github.com/spring-projects/spring-framework/blob/v5.0.13.RELEASE/spring-aop/src/main/java/org/springframework/aop/framework/CglibAopProxy.java#L159" target="_blank" rel="noopener">org.springframework.aop.framework.CglibAopProxy#getProxy(java.lang.ClassLoader)</a> 方法，其中 <a href="https://github.com/spring-projects/spring-framework/blob/v5.0.13.RELEASE/spring-aop/src/main/java/org/springframework/aop/framework/CglibAopProxy.java#L192" target="_blank" rel="noopener">192</a> 行配置了一个 <a href="https://github.com/spring-projects/spring-framework/blob/v5.0.13.RELEASE/spring-aop/src/main/java/org/springframework/aop/framework/CglibAopProxy.java#L973" target="_blank" rel="noopener">ClassLoaderAwareUndeclaredThrowableStrategy</a> 策略。</p>
<pre><code class="java">enhancer.setStrategy(new ClassLoaderAwareUndeclaredThrowableStrategy(classLoader));</code></pre>
<p>在 <code>ClassLoaderAwareUndeclaredThrowableStrategy</code> 策略的 <a href="https://github.com/spring-projects/spring-framework/blob/v5.0.13.RELEASE/spring-aop/src/main/java/org/springframework/aop/framework/CglibAopProxy.java#L984" target="_blank" rel="noopener">generate</a> 方法调用父类 UndeclaredThrowableStrategy =&gt; DefaultGeneratorStrategy 的 generate 方法时，可以获得到增强后的字节码。</p>
<h3 id="Fork"><a href="#Fork" class="headerlink" title="Fork"></a>Fork</h3><p>说到这时会发现一个问题，在 Spring Framework 的代码仓库中，没有上面提到的 <code>UndeclaredThrowableStrategy</code> 和 <code>DefaultGeneratorStrategy</code> 的源码，而这两个类明明是包含在 <code>spring-core</code> 的 jar 包中的。</p>
<p>spring-core 模块的构建文件 <a href="https://github.com/spring-projects/spring-framework/blob/v5.0.13.RELEASE/spring-core/spring-core.gradle" target="_blank" rel="noopener">spring-core.gradle</a> 给我们揭晓了答案：</p>
<pre><code class="spring-core.gradle">...

// spring-core includes asm and repackages cglib, inlining both into the spring-core jar.
// cglib itself depends on asm and is therefore further transformed by the JarJar task to
// depend on org.springframework.asm; this avoids including two different copies of asm.
def cglibVersion = &quot;3.2.6&quot;

...

task cglibRepackJar(type: Jar) { repackJar -&gt;
    repackJar.baseName = &quot;spring-cglib-repack&quot;
    repackJar.version = cglibVersion

    doLast() {
        project.ant {
            taskdef name: &quot;jarjar&quot;, classname: &quot;com.tonicsystems.jarjar.JarJarTask&quot;,
                    classpath: configurations.jarjar.asPath
            jarjar(destfile: repackJar.archivePath) {
                configurations.cglib.each { originalJar -&gt;
                    zipfileset(src: originalJar)
                }
                // Repackage net.sf.cglib =&gt; org.springframework.cglib
                rule(pattern: &quot;net.sf.cglib.**&quot;, result: &quot;org.springframework.cglib.@1&quot;)
                // As mentioned above, transform cglib&#39;s internal asm dependencies from
                // org.objectweb.asm =&gt; org.springframework.asm. Doing this counts on the
                // the fact that Spring and cglib depend on the same version of asm!
                rule(pattern: &quot;org.objectweb.asm.**&quot;, result: &quot;org.springframework.asm.@1&quot;)
            }
        }
    }
}

...</code></pre>
<p>所以在 <a href="https://github.com/cglib/cglib/tree/RELEASE_3_2_6" target="_blank" rel="noopener">cglib v3.2.6</a> 的仓库中，我们可以找到 <a href="https://github.com/cglib/cglib/blob/RELEASE_3_2_6/cglib/src/main/java/net/sf/cglib/transform/impl/UndeclaredThrowableStrategy.java" target="_blank" rel="noopener">UndeclaredThrowableStrategy</a> 和 <a href="https://github.com/cglib/cglib/blob/RELEASE_3_2_6/cglib/src/main/java/net/sf/cglib/core/DefaultGeneratorStrategy.java" target="_blank" rel="noopener">DefaultGeneratorStrategy</a>，以及 <a href="https://github.com/cglib/cglib/blob/RELEASE_3_2_6/cglib/src/main/java/net/sf/cglib/core/DefaultGeneratorStrategy.java#L23-L27" target="_blank" rel="noopener">可获取增强后字节码的地方</a>：</p>
<pre><code class="java">public byte[] generate(ClassGenerator cg) throws Exception {
    DebuggingClassWriter cw = getClassVisitor();
    transform(cg).generateClass(cw);
    return transform(cw.toByteArray());
}</code></pre>
<blockquote>
<p>断点加在 <code>cw.toByteArray()</code> 处，将其输出为 <code>.class</code> 文件，即可获得增强后的字节码，也就是 AOP 的代理类。</p>
</blockquote>
<h3 id="Join"><a href="#Join" class="headerlink" title="Join"></a>Join</h3><p>回到主线。反编译输出出来的 <code>.class</code> 文件，可与源码进行对比。</p>
<p>源码：</p>
<pre><code class="java">@PostMapping
public ResponseEntity post() {
    return responseOfPost(&quot;success&quot;);
}</code></pre>
<p>反编译代理类：</p>
<pre><code class="java">public final ResponseEntity post() {
    try {
        MethodInterceptor cglib$CALLBACK_2;
        MethodInterceptor cglib$CALLBACK_0;
        if ((cglib$CALLBACK_0 = (cglib$CALLBACK_2 = this.CGLIB$CALLBACK_0)) == null) {
            CGLIB$BIND_CALLBACKS(this);
            cglib$CALLBACK_2 = (cglib$CALLBACK_0 = this.CGLIB$CALLBACK_0);
        }
        if (cglib$CALLBACK_0 != null) {
            return (ResponseEntity)cglib$CALLBACK_2.intercept((Object)this, TestController$$EnhancerBySpringCGLIB$$ef60194e.CGLIB$post$5$Method, TestController$$EnhancerBySpringCGLIB$$ef60194e.CGLIB$emptyArgs, TestController$$EnhancerBySpringCGLIB$$ef60194e.CGLIB$post$5$Proxy);
        }
        return super.post();
    }
    catch (RuntimeException | Error ex) {
        throw;
    }
    catch (Throwable t) {
        throw new UndeclaredThrowableException(t);
    }
}</code></pre>
<blockquote>
<p>顺便吐个槽：老牌反编译软件 <a href="https://github.com/java-decompiler/jd-gui" target="_blank" rel="noopener">jd-gui</a> 反编译上面这段时，内容明显不对。<a href="https://github.com/deathmarine/Luyten" target="_blank" rel="noopener">Luyten</a> 反编译出了上述结果，但 <a href="https://github.com/deathmarine/Luyten/releases/tag/v0.5.4_Rebuilt_with_Latest_depenencies" target="_blank" rel="noopener">Luyten v0.5.4 Rebuilt</a> 里的 <a href="https://github.com/deathmarine/Luyten/releases/download/v0.5.4_Rebuilt_with_Latest_depenencies/luyten-OSX-0.5.4.zip" target="_blank" rel="noopener">Mac 版</a> 无任何响应。上述结果为在 Windows 下编译得到。</p>
</blockquote>
<p>总结一下，扣个题：</p>
<p>代理类将被代理调用的方法整个使用 try/catch 包了起来，将除 RuntimeException 和 Error 之外的异常，都包装成了 <code>UndeclaredThrowableException</code> 再向外抛出。</p>
<h2 id="对症下药"><a href="#对症下药" class="headerlink" title="对症下药"></a>对症下药</h2><p>所以遇到这个问题的时候，可以通过如下方式处理：</p>
<ol>
<li>在被代理的方法上，显示抛出检查型异常</li>
<li>切面里抛出 RuntimeException，替代检查型异常</li>
<li>不能更改异常类型又不想在方法上定义方法本身未进行抛出的异常时，可以使用一些迂回策略，比如在切面中直接按照统一异常处理的规则，返回将异常处理好的封装类型</li>
</ol>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ul>
<li><a href="https://www.jianshu.com/p/7edab536e4b9" target="_blank" rel="noopener">java.lang.reflect.UndeclaredThrowableException的解决</a></li>
<li><a href="https://msd.misuland.com/pd/3255817997595446638" target="_blank" rel="noopener">JDK动态代理UndeclaredThrowableException异常</a></li>
<li><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/reflect/Proxy.html" target="_blank" rel="noopener">java.lang.reflect.Proxy</a></li>
<li><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/reflect/InvocationHandler.html" target="_blank" rel="noopener">java.lang.reflect.InvocationHandler</a></li>
<li><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/reflect/UndeclaredThrowableException.html" target="_blank" rel="noopener">java.lang.reflect.UndeclaredThrowableException</a></li>
<li><a href="https://docs.spring.io/spring/docs/5.0.13.RELEASE/spring-framework-reference/core.html#aop-introduction-proxies" target="_blank" rel="noopener">AOP Proxies</a></li>
</ul>

            <!--[if lt IE 9]><script>document.createElement('audio');</script><![endif]-->
            <audio id="audio" loop="1" preload="auto" controls="controls"
                data-autoplay="false">
                <source type="audio/mpeg" src="">
            </audio>
            
            <ul id="audio-list" style="display:none">
                
                
                <li title='0' data-url='/statics/background.mp3'></li>
                
                    
            </ul>
            
            
            
    <div id='gitalk-container' class="comment link"
        data-ae='true'
        data-ci='54f9966b8cc9d2423ffd'
        data-cs='504574e4532bdfa77d3e4091637ff53558408ac2'
        data-r='AlphaHinex.github.io'
        data-o='AlphaHinex'
        data-a='AlphaHinex'
        data-d=''
    >留言</div>


            
            
        </div>
        <div class="sidebar">
            <div class="box animated fadeInRight">
                <div class="subbox">
                    <img src="/img/hinex.jpg" height=300 width=300></img>
                    <p>Alpha Hinex</p>
                    <span>Stay Hungry. Stay Foolish.</span>
                    <dl>
                        <dd><a href="https://github.com/AlphaHinex" target="_blank"><span
                                    class=" iconfont icon-github"></span></a></dd>
                        <dd><a href="/whoami"><span class=" iconfont icon-wechat"></span></a></dd>
                        <dd><a href="" target="_blank"><span
                                    class=" iconfont icon-stack-overflow"></span></a></dd>
                    </dl>
                </div>
                <ul>
                    <li><a href="/">314 <p>文章</p></a></li>
                    <li><a href="/categories">76 <p>分类</p></a></li>
                    <li><a href="/tags">153 <p>标签</p></a></li>
                </ul>
            </div>
            
            
            
            <div class="box sticky animated fadeInRight faster">
                <div id="toc" class="subbox">
                    <h4>目录</h4>
                    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#场景描述"><span class="toc-number">1.</span> <span class="toc-text">场景描述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#追根溯源"><span class="toc-number">2.</span> <span class="toc-text">追根溯源</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Fork"><span class="toc-number">2.1.</span> <span class="toc-text">Fork</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Join"><span class="toc-number">2.2.</span> <span class="toc-text">Join</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#对症下药"><span class="toc-number">3.</span> <span class="toc-text">对症下药</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#参考资料"><span class="toc-number">4.</span> <span class="toc-text">参考资料</span></a></li></ol>
                </div>
            </div>
            
            
        </div>
    </div>
</div>

    </div>
</div>
    <div id="back-to-top" class="animated fadeIn faster">
        <div class="flow"></div>
        <span class="percentage animated fadeIn faster">0%</span>
        <span class="iconfont icon-top02 animated fadeIn faster"></span>
    </div>
</body>
<footer>
    <p>本站访客数<span id="busuanzi_value_site_uv"></span>人次 / 本站总访问量<span id="busuanzi_value_site_pv"></span>次</p>
    <p class="copyright" id="copyright">
        &copy; 2025
        <span class="gradient-text">
            Alpha Hinex
        </span>.
        Powered by <a href="http://hexo.io/" title="Hexo" target="_blank" rel="noopener">Hexo</a>
        Theme
        <span class="gradient-text">
            <a href="https://github.com/TriDiamond/hexo-theme-obsidian" title="Obsidian" target="_blank" rel="noopener">Obsidian</a>
        </span>
        <small><a href="https://github.com/TriDiamond/hexo-theme-obsidian/blob/master/CHANGELOG.md" title="v1.4.3" target="_blank" rel="noopener">v1.4.3</a></small>
    </p>
</footer>

<script type="text/javascript" src="https://mirrors.sustech.edu.cn/cdnjs/ajax/libs/mathjax/2.7.6/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<script>
  MathJax.Hub.Config({
    "HTML-CSS": {
      preferredFont: "TeX",
      availableFonts: ["STIX", "TeX"],
      linebreaks: {
        automatic: true
      },
      EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50)
    },
    tex2jax: {
      inlineMath: [
        ["$", "$"],
        ["\\(", "\\)"]
      ],
      processEscapes: true,
      ignoreClass: "tex2jax_ignore|dno",
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    TeX: {
      noUndefined: {
        attributes: {
          mathcolor: "red",
          mathbackground: "#FFEEEE",
          mathsize: "90%"
        }
      },
      Macros: {
        href: "{}"
      }
    },
    messageStyle: "none"
  });
</script>
<script>
  function initialMathJax() {
    MathJax.Hub.Queue(function () {
      var all = MathJax.Hub.getAllJax(),
        i;
      // console.log(all);
      for (i = 0; i < all.length; i += 1) {
        console.log(all[i].SourceElement().parentNode)
        all[i].SourceElement().parentNode.className += ' has-jax';
      }
    });
  }

  function reprocessMathJax() {
    if (typeof MathJax !== 'undefined') {
      MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
    }
  }
</script>



    
<link rel="stylesheet" href="/css/gitalk.css">

    
<script src="/js/gitalk.min.js"></script>



<script src="/js/jquery-3.4.1.min.js"></script>
<script src="/js/plugin.js"></script>
<script src="/js/obsidian.js"></script>
<script src="/js/jquery.truncate.js"></script>
<script src="/js/search.js"></script>


<script src="//mirrors.sustech.edu.cn/cdnjs/ajax/libs/typed.js/2.0.10/typed.min.js"></script>


<script src="//mirrors.sustech.edu.cn/cdnjs/ajax/libs/blueimp-md5/2.12.0/js/md5.min.js"></script>


<script src="/js/social-share.min.js"></script>


<script src="https://mirrors.sustech.edu.cn/cdnjs/ajax/libs/codemirror/5.48.4/codemirror.min.js"></script>

    
<script src="//mirrors.sustech.edu.cn/cdnjs/ajax/libs/codemirror/5.48.4/mode/javascript/javascript.min.js"></script>


    
<script src="//mirrors.sustech.edu.cn/cdnjs/ajax/libs/codemirror/5.48.4/mode/css/css.min.js"></script>


    
<script src="//mirrors.sustech.edu.cn/cdnjs/ajax/libs/codemirror/5.48.4/mode/xml/xml.min.js"></script>


    
<script src="//mirrors.sustech.edu.cn/cdnjs/ajax/libs/codemirror/5.48.4/mode/htmlmixed/htmlmixed.min.js"></script>


    
<script src="//mirrors.sustech.edu.cn/cdnjs/ajax/libs/codemirror/5.48.4/mode/clike/clike.min.js"></script>


    
<script src="//mirrors.sustech.edu.cn/cdnjs/ajax/libs/codemirror/5.48.4/mode/php/php.min.js"></script>


    
<script src="//mirrors.sustech.edu.cn/cdnjs/ajax/libs/codemirror/5.48.4/mode/shell/shell.min.js"></script>


    
<script src="//mirrors.sustech.edu.cn/cdnjs/ajax/libs/codemirror/5.48.4/mode/python/python.min.js"></script>


    
<script src="//mirrors.sustech.edu.cn/cdnjs/ajax/libs/codemirror/5.48.4/mode/groovy/groovy.min.js"></script>


    
<script src="//mirrors.sustech.edu.cn/cdnjs/ajax/libs/codemirror/5.48.4/mode/diff/diff.min.js"></script>


    
<script src="//mirrors.sustech.edu.cn/cdnjs/ajax/libs/codemirror/5.48.4/mode/nginx/nginx.min.js"></script>


    
<script src="//mirrors.sustech.edu.cn/cdnjs/ajax/libs/codemirror/5.48.4/mode/properties/properties.min.js"></script>




    
<script src="/js/busuanzi.min.js"></script>

    <script>
        $(document).ready(function () {
            if ($('span[id^="busuanzi_"]').length) {
                initialBusuanzi();
            }
        });
    </script>



<link rel="stylesheet" href="//mirrors.sustech.edu.cn/cdnjs/ajax/libs/photoswipe/4.1.3/photoswipe.min.css">
<link rel="stylesheet" href="//mirrors.sustech.edu.cn/cdnjs/ajax/libs/photoswipe/4.1.3/default-skin/default-skin.min.css">


<script src="//mirrors.sustech.edu.cn/cdnjs/ajax/libs/photoswipe/4.1.3/photoswipe.min.js"></script>
<script src="//mirrors.sustech.edu.cn/cdnjs/ajax/libs/photoswipe/4.1.3/photoswipe-ui-default.min.js"></script>


<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>
    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">
        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>
        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">
            <div class="pswp__top-bar">
                <!--  Controls are self-explanatory. Order can be changed. -->
                <div class="pswp__counter"></div>
                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
                <button class="pswp__button pswp__button--share" title="Share"></button>
                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>
            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>
            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>
            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>
            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>
        </div>
    </div>
</div>



    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="//www.googletagmanager.com/gtag/js?id=UA-69084811-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-69084811-1');
    </script>





<script>
    function initialTyped () {
        var typedTextEl = $('.typed-text');
        if (typedTextEl && typedTextEl.length > 0) {
            var typed = new Typed('.typed-text', {
                strings: ["Stay Hungry. Stay Foolish.", "常与同好争高下，莫与傻子论短长"],
                typeSpeed: 90,
                loop: true,
                loopCount: Infinity,
                backSpeed: 20,
            });
        }
    }

    if ($('.article-header') && $('.article-header').length) {
        $(document).ready(function () {
            initialTyped();
        });
    }
</script>




</html>
